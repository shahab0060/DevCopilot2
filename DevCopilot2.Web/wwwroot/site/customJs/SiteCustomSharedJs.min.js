async function RemoveOutOfStockOrderDetails(){IsUserAuthenticated()&&1==+$("#remove-out-of-stock-order-details").val()&&$("#remove-out-of-stock-order-details-form").submit()}async function ShowAdminDropDown(){var response,dropDownHtml;!0===(await Get("/User/IsAdmin")).data&&$('<div class="dropdown ps-3 ms-0">\n                            <a class="topbar-link"\n                               href="/admin"\n                               title="پنل ادمین">\n                               پنل ادمین\n                            </a>\n            </div>').insertBefore("#logout-nav-item")}function ShowActivePhoneNumberOtp(){var firstValidItem=GetFirstValidPhoneNumberOtpCode();null!=firstValidItem&&($(".phonenumber-input").val(firstValidItem.phoneNumber),$("#register-login-form").addClass("d-none"),$("#login-form").removeClass("d-none"),StartResendOtpTimer(new Date(firstValidItem.sentDateTime)))}function HandleOtpCodeSent(phoneNumber){UpsertOtpCode(phoneNumber)}function GetPhoneNumberOtpExpireDate(phoneNumber){var list,item=getList("otpCodeList").filter(a=>a.phoneNumber==phoneNumber)[0],sentDateTime;return item?new Date(item.sentDateTime):null}function GetFirstValidPhoneNumberOtpCode(){var list=getList("otpCodeList"),currentDateTime=new Date,result=null;return list.forEach((function(item){var expireDateTime;if(new Date(item.sentDateTime)>currentDateTime)return result=item,item})),result}function UpsertOtpCode(phoneNumber){var list=getList("otpCodeList"),currentDateTime=(new Date).toISOString();(currentDateTime=new Date(currentDateTime)).setMinutes(currentDateTime.getMinutes()+2);var found=!1;list.forEach((function(item){item.phoneNumber===phoneNumber&&(item.sentDateTime=currentDateTime,found=!0)})),found||list.push({phoneNumber:phoneNumber,sentDateTime:currentDateTime}),StartResendOtpTimer(new Date(currentDateTime)),saveList(list,"otpCodeList")}var timerInterval;function StartResendOtpTimer(stopDateTime){timerInterval&&clearInterval(timerInterval),timerInterval=setInterval((function(){var currentDateTime=new Date,timeRemaining=stopDateTime.getTime()-currentDateTime.getTime();if(timeRemaining<=0)clearInterval(timerInterval),$("#resend-code-btn span").text("ارسال مجدد کد"),$("#resend-code-btn").removeAttr("disabled"),$("#resend-code-btn").removeClass("disabled");else{var minutes=Math.floor(timeRemaining/6e4),seconds=Math.floor(timeRemaining%6e4/1e3);$("#resend-code-btn").attr("disabled",""),$("#resend-code-btn").addClass("disabled");var remainingTime=(minutes<10?"0":"")+minutes+":"+(seconds<10?"0":"")+seconds;$("#resend-code-btn span").text(`تا ارسال مجدد کد ${remainingTime}`)}}),1e3)}function RemovePhoneNumberFromList(phoneNumber){var list=getList("otpCodeList");list=list.filter(a=>a.phoneNumber!=phoneNumber),saveList(list,"otpCodeList")}async function AddToCartBtnClicked($btn){basketProducts=await UpsertToBasket($btn),localStorage.setItem("basketProducts",JSON.stringify(basketProducts)),await UpdateBasketProductsBtns(basketProducts),await UpdateBasket(basketProducts)}function HandleSizeSelectedChange(element){var productId=$(element).attr("data-product-id"),value=$(element).val();$('.size-select[data-product-id="'+productId+'"]').val(value),$('.add-to-cart-btn[data-product-id="'+productId+'"]').addClass("d-real-none"),$('.add-to-cart-btn[data-value="'+value+'"]').removeClass("d-real-none");var selectedValue=$(element).val(),matchingOption;ShowSingleSizePrices($(element).find("option").filter((function(){return $(this).val()===selectedValue})))}function ShowSingleSizePrices(element){var price=$(element).data("price");if(price){var discount=$(element).data("discount"),quantity,finalPrice=price-(discount>0?discount:0),html=$(element).data("quantity-remaining")<=0?"":`<li class="list-inline-item h4 fw-light mb-0">\n          ${$.ToAmount(finalPrice)}\n         </li>\n         ${discount>0?`\n             <li class="list-inline-item text-muted fw-light">\n                                    <del>${$.ToAmount(price)}</del>\n             </li>`:""}`;$(".size-price-section-container").html(html)}}function SetSizeInBasketAsDefaultSize(productId){var sizes=[];if($(`.size-select[data-product-id='${productId}'] option`).each((function(){sizes.push($(this).val())})),0===sizes.length)return;let basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];var firstSizeInBasket=$.grep(sizes,(function(sizeId){return $.grep(basketProducts,(function(product){return sizeId===product.id.toString()})).length>0}))[0];null!=firstSizeInBasket&&firstSizeInBasket>0&&($(`.size-select[data-product-id='${productId}']`).val(firstSizeInBasket).change(),$(`.size-select[data-product-id='${productId}'] option[value="${firstSizeInBasket}"]`).prop("selected",!0))}$(document).ready((async function(e){function highlightThumb(){var sliderId=this.$el.attr("id"),thumbs=$('.swiper-thumbs[data-swiper="#'+sliderId+'"]');thumbs.length>0&&(thumbs.find(".swiper-thumb-item.active").removeClass("active"),thumbs.find(".swiper-thumb-item").eq(this.realIndex).addClass("active"))}await ShowAdminDropDown(),$(document).on("click",".quick-view-btn",(async function(e){var value=$(this).attr("data-value");open_waiting("#quickview-modal-container");try{const response=await $.ajax({type:"GET",url:`/proudcts/detail/partial/${value}`});if("danger"===response.status)return ShowErrorMessage("مشکلی در نمایش محصول پیش آمد!."),void close_waiting("#quickview-modal-container");close_waiting("#quickview-modal-container"),$("#quickview-modal-container").html(response),quickViewSlider=new Swiper("#quickViewSlider",{mode:"horizontal",loop:!0,on:{slideChangeTransitionStart:highlightThumb}});let basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];await UpdateBasketProductsBtns(basketProducts);let favoriteProducts=JSON.parse(localStorage.getItem("favoriteProducts"))||[];await UpdateFavoriteProductsBtns(favoriteProducts),$(document).on("click",".swiper-thumb-item",(function(e){e.preventDefault();var swiperId=$(this).parents(".swiper-thumbs").data("swiper");$(swiperId)[0].swiper.slideToLoop($(this).index())})),$(".selectpicker").selectpicker("refresh")}catch(error){return console.error("Error getting product information:",error),close_waiting("#quickview-modal-container"),null}}));let favoriteProducts=JSON.parse(localStorage.getItem("favoriteProducts"))||[],basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];await UpdateBasket(basketProducts),await UpdateFavoriteProductsBtns(favoriteProducts),await UpdateBasketProductsBtns(basketProducts),$(document).on("submit","#remove-out-of-stock-order-details-form",(async function(e){e.preventDefault(),await GetFormResult("remove-out-of-stock-order-details-form")})),await RemoveOutOfStockOrderDetails(),$(document).on("click",".update-basket-btn",(async function(e){await UpdateBasket(basketProducts),await UpdateBasketProductsBtns(basketProducts),ShowSuccessMessage("سبد خرید شما بروز است")})),$(document).on("click",".favorite-btn",(function(){const $btn=$(this),value=$btn.data("value");$btn.hasClass("checked")?favoriteProducts=favoriteProducts.filter(item=>item!==value):favoriteProducts.push(value),$('.favorite-btn[data-value="'+value+'"]').toggleClass("checked"),localStorage.setItem("favoriteProducts",JSON.stringify(favoriteProducts)),UpdateFavoriteProductsBtns(favoriteProducts)})),$(document).on("click",".add-to-cart-btn",(async function(){var productId=$(this).data("product-id");open_waiting(`.single-product-item[data-value=${productId}]`);const $btn=$(this);await AddToCartBtnClicked($btn),close_waiting(`.single-product-item[data-value=${productId}]`)})),$(document).on("change",".size-select",(function(e){HandleSizeSelectedChange($(this))})),ShowActivePhoneNumberOtp(),$(document).on("submit","#register-login-form",(async function(e){e.preventDefault(),$("#submit-phone-number-btn").addClass("disabled");var phoneNumber=$("#register-login-phonenumber-input").val();if(null==phoneNumber||phoneNumber.length<11)return ShowErrorMessage("شماره تلفن وارد شده معتبر نمی باشد"),void $("#submit-phone-number-btn").removeClass("disabled");var expireDate=GetPhoneNumberOtpExpireDate(phoneNumber),currentDateTime=new Date;if(null==expireDate||expireDate<currentDateTime){var result=await GetFormResult("register-login-form");if(null===result)return ShowErrorMessage("مشکلی در انجام عملیات پیش آمد"),void $("#submit-phone-number-btn").removeClass("disabled");if("Danger"===result.status)return ShowErrorMessage(result.message),void $("#submit-phone-number-btn").removeClass("disabled");ShowSuccessMessage("کد ورود برای شما ارسال شد"),HandleOtpCodeSent(phoneNumber),$("#submit-phone-number-btn").removeClass("disabled")}else ShowInfoMessage("کد تایید از قبل برای شما ارسال شده است"),$("#submit-phone-number-btn").removeClass("disabled");$(".phonenumber-input").val(phoneNumber),$("#register-login-form").addClass("d-none"),$("#login-form").removeClass("d-none"),$("#submit-phone-number-btn").removeClass("disabled")}));var previousPhoneNumberOtpCode="";$(document).on("keyup","#phonenumber-otp-code-input",(function(e){var value,length;4===$(this).val().length&&$("#login-form").submit()})),$(document).on("keyup","#register-login-phonenumber-input",(function(e){var value,length;11===$(this).val().length&&$("#register-login-form").submit()})),$(document).on("submit","#login-form",(async function(e){e.preventDefault();var otpCode=$("#phonenumber-otp-code-input").val();if(otpCode!==previousPhoneNumberOtpCode){previousPhoneNumberOtpCode=otpCode;var response=await GetFormResult("login-form");if(ShowMessageByResponse(response),"success"===response.status.toLowerCase()){var redirectUrl=$("#redirect-url-input").val(),phoneNumber;return RemovePhoneNumberFromList($("#register-login-phonenumber-input").val()),await AddLocalBasketItemsToServer(basketProducts),void(window.location.href=redirectUrl)}}else ShowErrorMessage("کد وارد شده اشتباه است ")})),$(document).on("input",".phonenumber-input",(function(){$(this).val().length>11&&$(this).val($(this).val().substring(0,11))})),$(document).on("input","#phonenumber-otp-code-input",(function(){$(this).val().length>4&&$(this).val($(this).val().substring(0,4))})),$(document).on("click",".authorize-required",(function(e){if(!IsUserAuthenticated()){e.preventDefault();var href=$(this).attr("href");$("#redirect-url-input").val(href),$(".modal").modal("hide"),$("#loginModal").modal("show"),ShowInfoMessage("برای دیدن این صفحه لطفا به سایت ورود کنید")}})),$(document).on("click","#edit-phonenumber-btn",(function(e){$("#phonenumber-otp-code-input").val(""),$("#register-login-form").removeClass("d-none"),$("#login-form").addClass("d-none")})),$(document).on("click","#resend-code-btn",(function(e){$(this).hasClass("disabled")||($(this).addClass("disabled"),$("#resend-otp-code-form").submit())})),$(document).on("submit","#resend-otp-code-form",(async function(e){e.preventDefault(),$("#resend-code-btn").addClass("disabled");var response=await GetFormResult("resend-otp-code-form"),phoneNumber;(ShowMessageByResponse(response),"success"===response.status.toLowerCase())&&HandleOtpCodeSent($("#register-login-phonenumber-input").val());$("#resend-code-btn").removeClass("disabled")}))})),$(window).on("load",(function(){$(".defer-stylesheet").each((function(){var src;AppendStyleSheet($(this).data("src"))}))})),$(document).on("change",".size-select",(function(){HandleSizeSelectedChange($(this))}));var removeSuccessMessagesCount=0;async function UpsertToBasket($btn){basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];const value=$btn.data("value");var isMinimal=$btn.hasClass("minimal"),productId=$btn.data("product-id");if($btn.hasClass("checked"))if(isMinimal){var products=basketProducts.filter(a=>a.productId==productId);removeSuccessMessagesCount=0,products.forEach((async function(item){basketProducts=await RemoveSingleProductFromBasket(item.id)})),removeSuccessMessagesCount=0}else basketProducts=await RemoveSingleProductFromBasket(value);else{var maxCount=$btn.data("quantity-remaining"),preferedCount=$("#count").val();(null==preferedCount||preferedCount<=0)&&(preferedCount=1);var currentItemInBasket=basketProducts.filter(item=>item.id==value),currentItemCount=0;currentItemInBasket.length>0&&(currentItemCount=currentItemInBasket.count);var totalCount=+currentItemCount+ +preferedCount,productId=$btn.data("product-id");if(+totalCount>+maxCount)return ShowErrorMessage("تعداد درخواستی شما از تعداد موجود در انبار بیشتر است"),basketProducts;IsUserAuthenticated()?await AddToServerBasket(value,totalCount):(ShowSuccessMessage("محصول مورد نظر به سبد خرید اضافه شد"),$("#sidebarCart").modal("show")),basketProducts.push({id:value,count:totalCount,productId:productId,createDate:(new Date).toLocaleString()})}return basketProducts}async function RemoveSingleProductFromBasket(value){var success=!0;return IsUserAuthenticated()&&(success=await RemoveFromServerBasket(value)),basketProducts=basketProducts.filter(item=>item.id!==value),success&&0===removeSuccessMessagesCount&&(ShowSuccessMessage("محصول مورد نظر از سبد خرید حذف شد"),removeSuccessMessagesCount++),basketProducts}async function AddToServerBasket(id,count){try{const result=await $.ajax({url:`/order/add-to-basket-json/${id}/${count}`,method:"GET"});return ShowMessageByResponse(result),"Success"===result.status?(await UpdateBasketProductsBtns(),await UpdateBasket(),$("#sidebarCart").modal("show"),await!0):await!1}catch(error){return console.error("Error adding product to basket:",error),await!1}}async function RemoveFromServerBasket(id){try{const result=await $.ajax({url:`/order/remove-product-from-basket-json/${id}`,method:"GET"});return"Success"===result.status?(await UpdateBasketProductsBtns(),await UpdateBasket(),await!0):await!1}catch(error){return console.error("Error while removing product from basket:",error),await!1}}async function LoadFromServerBasket(){try{const result=await $.ajax({url:"/order/basket-json",method:"GET"});if("Success"===result.status){var newBasketProductsArray=[];return result.data.forEach((function(product){newBasketProductsArray.push({id:product.id,count:product.count,productId:product.productId,createDate:product.createDate})})),localStorage.setItem("basketProducts",JSON.stringify(newBasketProductsArray)),await ShowBasket(result.data),await!0}return await!1}catch(error){return console.error("Error adding product to basket:",error),await!1}}async function DecrementFromServerBasket(id){try{const result=await $.ajax({url:`/order/decrement-basket-json/${id}`,method:"GET"});return"Success"===result.status?(await UpdateBasketProductsBtns(),await UpdateBasket(),await!0):await!1}catch(error){return console.error("Error decrementing product from basket:",error),await!1}}async function ChangeCountFromServerBasket(id,count){try{const result=await $.ajax({url:`/order/change-basket-count-json/${id}/${count}`,method:"GET"});return ShowMessageByResponse(result),"Success"===result.status?(await UpdateBasketProductsBtns(),await UpdateBasket(),await!0):await!1}catch(error){return console.error("Error changing product count from basket:",error),await!1}}function UpdateFavoriteProductsBtns(favoriteProducts){favoriteProducts.forEach(value=>{$('.favorite-btn[data-value="'+value+'"]').addClass("checked")}),$(".favorite-products-count").text(favoriteProducts.length),$(".favorite-btn").each((function(){const $btn=$(this);var isCustomIcon;$btn.hasClass("has-custom-icon")?$btn.hasClass("checked")?$btn.html('<svg class="svg-icon svg-icon-heavy">\n                          <use xlink:href="#heart-fill"> </use>\n                        </svg>'):$btn.html('<svg class="svg-icon svg-icon-heavy">\n                          <use xlink:href="#heart-1"> </use>\n                        </svg>'):$btn.hasClass("checked")?$btn.html('<i class="far fa-heart me-2"></i>حذف از مورد علاقه ها'):$btn.html('<i class="far fa-heart me-2"></i>افزودن به موردعلاقه ها')}))}async function UpdateBasketProductsBtns(basketProducts){if(IsUserAuthenticated())try{const result=await $.ajax({url:"/order/basket-json",method:"GET"});"Success"===result.status&&(basketProducts=result.data)}catch(error){console.error("Error adding product to basket:",error)}$(".add-to-cart-btn").removeClass("checked"),basketProducts||(basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[]),basketProducts.forEach(item=>{$('.add-to-cart-btn[data-value="'+item.id+'"]').addClass("checked"),$('.add-to-cart-btn.minimal[data-product-id="'+item.productId+'"]').addClass("checked")}),$(".add-to-cart-btn").each((function(){const $btn=$(this),isMinimal=$(this).hasClass("minimal"),quantity=$(this).data("quantity-remaining");quantity<=0?($btn.text("ناموجود"),$btn.attr("disabled","true"),$btn.addClass("default-cursor")):isMinimal?$btn.hasClass("checked")?($btn.removeClass("text-dark"),$btn.addClass("text-danger"),$btn.hasClass("has-icon")||$btn.text("حذف")):($btn.addClass("text-dark"),$btn.removeClass("text-danger"),$btn.hasClass("has-icon")||$btn.text("خرید")):$btn.hasClass("checked")?($btn.removeClass("btn-dark"),$btn.addClass("btn-danger"),$btn.hasClass("has-icon")||$btn.html('\n                    <i class="fa fa-shopping-cart me-2"></i>\n                    حذف از سبد خرید')):($btn.addClass("btn-dark"),$btn.removeClass("btn-danger"),$btn.hasClass("has-icon")||$btn.html('\n                    <i class="fa fa-shopping-cart me-2"></i>\n                    افزودن به سبد خرید'))}))}async function UpdateBasket(basketProducts){IsUserAuthenticated()?await LoadFromServerBasket():await ShowBasket(basketProducts)}async function AddLocalBasketItemsToServer(basketProducts){if(basketProducts)for(var product of basketProducts)await AddToServerBasket(product.id,product.count)}async function ShowBasket(basketProducts){if($("#basket-items-content-container").empty(),$("#cart-page-items-container").empty(),0==basketProducts.length||null==basketProducts)return $(".empty-basket-container").removeClass("d-none"),$(".basket-items-content-container").addClass("d-none"),$(".basket-buttons-container").addClass("d-none"),void $(".basket-items-count-span").html("0");$(".empty-basket-container").addClass("d-none"),$(".basket-items-content-container").removeClass("d-none"),$(".basket-items-count-span").html("0");let totalPrice=0,totalDiscount=0,productsCount=0;basketProducts.sort((function(a,b){return new Date(a.createDate)-new Date(b.createDate)}));for(const item of basketProducts)try{const result=await $.ajax({url:`/ProductSelectedOptionValue/Detail/${item.id}`,method:"GET"});var product=result.data;if(null!=product){product.quantityInStock>0&&(totalPrice+=+product.price*item.count,+product.discountPrice>0&&(totalDiscount+=+product.discountPrice*item.count),productsCount++),product.productImageName=$.ConvertImageNameToWebP(product.productImageName),$("#cart-page-items-container").append(GetBasketPageItemHtml(product,item.count));var itemHtml=GetBasketItemHtml(product,item.count);$("#basket-items-content-container").append(itemHtml)}}catch(error){console.error("Error fetching product:",error)}$(".basket-items-count-span").html(productsCount),$("#basket-total-price-container").html(`${totalDiscount>0?`\n                       <h5 class="mb-4">\n                            مبلغ کل:\n                            <s class="me-2 text-gray-500">\n                            ${totalPrice.toLocaleString()}\n                            </s>\n                        </h5>`:""}\n        <h5 class="mb-4">\n                        قابل پرداخت:\n                           <span class="float-right">\n                        ${(totalPrice-totalDiscount).toLocaleString()}\n                           </span>\n                        </h5>`),$(".basket-total-price").text(totalPrice.toLocaleString()),$(".basket-final-price").text((totalPrice-totalDiscount).toLocaleString())}function GetBasketItemHtml(product,count){var url=GetProductUrl(product),baseImagePath=$("#product-base-img-path").val();return product.productTitle=`${product.productTitle} ${product.productOptionTitle} ${product.productOptionValueTitle}`,`\n    <div class="navbar-cart-product">\n                        <div class="d-flex align-items-center">\n                            <a href="${url}" title="${product.productTitle}">\n                                <img class="img-fluid navbar-cart-product-image"\n                                     src="${baseImagePath+product.productImageName}"\n                                     alt="${product.productTitle}" title="${product.productTitle}" />\n                            </a>\n                            <div class="w-100">\n                                <a class="navbar-cart-product-remove" \n                                   onclick="RemoveSingleProductInBasket(${product.id})">\n                                    <svg class="svg-icon sidebar-cart-icon">\n                                        <use xlink:href="#close-1"> </use>\n                                    </svg>\n                                </a>\n                                ${product.quantityInStock>0?GetBasketItemPriceSectionHtml(product,count):GetBasketItemNoQuantitySectionHtml(product)}\n                            </div>\n                        </div>\n                    </div>`}function GetBasketItemPriceSectionHtml(product,count){var url=GetProductUrl(product),currentPrice=product.price-(product.discountPrice>0?product.discountPrice:0);return`\n                   <div class="ps-3">\n                        <a class="navbar-cart-product-link text-dark link-animated"\n                           href="${url}" title="${product.productTitle}"\n                           >${product.productTitle}</a>\n                        <small class="d-block text-muted">تعداد: ${count} </small>\n                        ${product.discountPrice>0?`<s class="me-2 text-gray-500">${product.price.toLocaleString()}</s>`:""}\n                        <strong class="d-block text-sm">${currentPrice.toLocaleString()}</strong>\n                    </div>`}function GetBasketItemNoQuantitySectionHtml(product){var url;return`\n                   <div class="ps-3">\n                        <a class="navbar-cart-product-link text-dark link-animated"\n                           href="${GetProductUrl(product)}" title="${product.productTitle}"\n                           >${product.productTitle}</a>\n                        <small class="d-block text-danger">ناموجود</small>\n                    </div>`}function GetBasketPageInStockItemHtml(product,count){var url=GetProductUrl(product),baseImagePath=$("#product-base-img-path").val(),finalPrice=product.price;return product.discountPrice>0&&(finalPrice-=+product.discountPrice),`\n    <div class="cart-item">\n        <div class="row d-flex align-items-center text-start text-md-center">\n            <div class="col-12 col-md-5">\n                <a class="cart-remove close mt-3 d-md-none" \n                href="#" onclick="RemoveSingleProductInBasket(${product.id})">\n                <i class="fa fa-times"></i>\n                </a>\n                <div class="d-flex align-items-center">\n                    <a href="${url}" title="${product.productTitle}">\n                    <img class="cart-item-img"\n                    src="${baseImagePath+product.productImageName}" \n                    alt="${product.productTitle}">\n                    </a>\n                    <div class="cart-title text-start">\n                        <a class="text-dark link-animated" \n                        href="${url}" title="${product.productTitle}">\n                        <strong>${product.productTitle}</strong>\n                        </a>\n                        <br>\n                        <span class="text-muted text-sm">\n                        ${product.productOptionTitle}: \n                        ${product.productOptionValueTitle}</span>\n                       </div>\n                </div>\n            </div>\n            <div class="col-12 col-md-7 mt-4 mt-md-0">\n                <div class="row align-items-center">\n                    <div class="col-md-3">\n                        <div class="row">\n                            <div class="col-6 d-md-none text-muted">قیمت هر عدد</div>\n                            <div class="col-6 col-md-12 text-end\n                            text-md-center">${finalPrice.toLocaleString()}\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-4">\n                        <div class="row align-items-center">\n                            <div class="d-md-none col-7 \n                            col-sm-9 text-muted">تعداد</div>\n                            <div class="col-5 col-sm-3 col-md-12">\n                                <div class="d-flex align-items-center">\n                                    <button class="btn btn-items \n                                    btn-items-decrease" \n                                    onclick="DecrementSingleProductInBasket(${product.id})"\n                                    >-</button>\n                                    <input class="form-control text-center border-0 \n                                    border-md input-items" type="text" value="${count}"\n                                    onchange="ChangeSingleProductCountInBasket(this)"\n                                    data-value="${product.id}"\n                                    data-max-value="${product.quantityInStock}">\n                                    <button class="btn btn-items btn-items-increase"\n                                    onclick="IncrementSingleProductInBasket(${product.id},${+count+1},${product.quantityInStock})"\n                                    >+</button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3">\n                        <div class="row">\n                            <div class="col-6 d-md-none text-muted">قیمت کل</div>\n                            <div class="col-6 col-md-12 text-end text-md-center">\n                            ${(finalPrice*count).toLocaleString()}\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-2 d-none d-md-block text-center">\n                        <a class="cart-remove text-muted" href="#"\n                        onclick="RemoveSingleProductInBasket(${product.id})">\n                            <svg class="svg-icon w-2rem h-2rem svg-icon-light">\n                                <use xlink:href="#close-1"> </use>\n                            </svg>\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>`}function GetBasketPageOutOfStockItemHtml(product){var url=GetProductUrl(product),baseImagePath=$("#product-base-img-path").val();return`\n    <div class="cart-item">\n        <div class="row d-flex align-items-center text-start text-md-center">\n            <div class="col-12 col-md-5">\n                <a class="cart-remove close mt-3 d-md-none"\n                href="#" onclick="RemoveSingleProductInBasket(${product.id})">\n                <i class="fa fa-times"></i>\n                </a>\n                <div class="d-flex align-items-center">\n                    <a href="${url}" title="${product.productTitle}">\n                    <img class="cart-item-img"\n                    src="${baseImagePath+product.productImageName}" \n                    alt="${product.productTitle}">\n                    </a>\n                    <div class="cart-title text-start">\n                        <a class="text-dark link-animated" \n                        href="${url}" title="${product.productTitle}">\n                        <strong>${product.productTitle}</strong>\n                        </a>\n                        <br>\n                        <span class="text-muted text-sm">\n                        ${product.productOptionTitle}: \n                        ${product.productOptionValueTitle}</span>\n                       </div>\n                </div>\n            </div>\n            <div class="col-12 col-md-7 mt-4 mt-md-0">\n                <div class="row align-items-center">\n                    <div class="col-md-10 text-end\n                            text-md-center text-danger">\n                        ناموجود\n                    </div>\n\n\n                    <div class="col-2 d-none d-md-block text-center">\n                        <a class="cart-remove text-muted" href="#" onclick="RemoveSingleProductInBasket(${product.id})">\n                            <svg class="svg-icon w-2rem h-2rem svg-icon-light">\n                                <use xlink:href="#close-1"> </use>\n                            </svg>\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>`}function GetBasketPageItemHtml(product,count){return product.quantityInStock>0?GetBasketPageInStockItemHtml(product,count):GetBasketPageOutOfStockItemHtml(product)}function GetProductUrl(product){return`/products/detail/${product.productId}/${ToUrl(product.productTitle)}`}function GetProductListDtoUrl(product){return`/products/detail/${product.id}/${ToUrl(product.title)}`}async function RemoveSingleProductInBasket(id){IsUserAuthenticated()&&await RemoveFromServerBasket(id);let basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];basketProducts=basketProducts.filter(item=>item.id!=id),localStorage.setItem("basketProducts",JSON.stringify(basketProducts)),await UpdateBasketProductsBtns(basketProducts),await UpdateBasket(basketProducts)}async function IncrementSingleProductInBasket(id,count,quantityInStock){if(+count>+quantityInStock)return void ShowErrorMessage("تعداد درخواستی از تعداد موجود بیشتر است");IsUserAuthenticated()&&await AddToServerBasket(id,count);let basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];const existingProduct=basketProducts.find(item=>item.id===id);existingProduct?existingProduct.count++:basketProducts.push({id:id,count:1}),basketProducts=basketProducts.filter(item=>item.count>0),localStorage.setItem("basketProducts",JSON.stringify(basketProducts)),await UpdateBasketProductsBtns(basketProducts),await UpdateBasket(basketProducts)}async function DecrementSingleProductInBasket(id){IsUserAuthenticated()&&await DecrementFromServerBasket(id);let basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];const existingProduct=basketProducts.find(item=>item.id===id);existingProduct&&existingProduct.count--,basketProducts=basketProducts.filter(item=>item.count>0),localStorage.setItem("basketProducts",JSON.stringify(basketProducts)),await UpdateBasketProductsBtns(basketProducts),await UpdateBasket(basketProducts)}async function ChangeSingleProductCountInBasket(element){var id=$(element).data("value"),count=$(element).val(),maxCount;if(+count>+$(element).data("max-value"))return void ShowErrorMessage("تعداد درخواستی از موجودی انبار بیشتر است");IsUserAuthenticated()&&await ChangeCountFromServerBasket(id,count);let basketProducts=JSON.parse(localStorage.getItem("basketProducts"))||[];const existingProduct=basketProducts.find(item=>item.id===id);existingProduct&&(existingProduct.count=+count),basketProducts=basketProducts.filter(item=>item.count>0),localStorage.setItem("basketProducts",JSON.stringify(basketProducts)),await UpdateBasketProductsBtns(basketProducts),await UpdateBasket(basketProducts)}function AppendStyleSheet(url){var link=document.createElement("link");link.rel="stylesheet",link.href=url,document.head.appendChild(link)}