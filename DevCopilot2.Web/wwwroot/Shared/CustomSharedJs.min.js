function getList(name){var list=localStorage.getItem(name);return list?JSON.parse(list):[]}function saveList(list,name){localStorage.setItem(name,JSON.stringify(list))}function FillPageId(pageId){$("#PageId").val(+pageId),$("#filterForm").submit(),$(".filterForm").submit(),$(".FilterForm").submit()}function ToAmount(number){if("number"!=typeof number||isNaN(number)||number<0)return void console.error("Invalid input. Please provide a positive number.");const formattedNumber=number.toLocaleString(),result=formattedNumber+" تومان";return result}function toShamsi(dateString){var date,persianDate;return new Date(dateString).toLocaleDateString("fa-IR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/-/g,"/")}function ReloadPage(){location.reload()}function InitialAmountTexts(){$('input[name="Price"]').each((function(){AddAmountText(this)})),$('input[name="Amount"]').each((function(){AddAmountText(this)})),$(".price-input").each((function(){AddAmountText(this)})),$(".Price-input").each((function(){AddAmountText(this)}))}function AddAmountText(element){var $span=$(element).next("p");0===$span.length&&($span=$("<p>").css("color","grey").insertAfter(element)),$(element).keyup((function(){var price=parseFloat($(element).val().replace(/,/g,"")),formattedPrice=isNaN(price)?"":price.toLocaleString("fa-IR")+" تومان";$span.text(formattedPrice)}));var initialPrice=parseFloat($(element).val().replace(/,/g,"")),initialFormattedPrice=isNaN(initialPrice)?"":initialPrice.toLocaleString("fa-IR")+" تومان";$span.text(initialFormattedPrice)}function IsUserAuthenticated(){var authenticated=$("#is-user-authenticated").val();return 1==+authenticated||!0===authenticated}function ToUrl(url){return url.toLowerCase().trim().replace(/ /g,"-").replace(/%/g,"-").replace(/&/g,"").replace("  "," ").replace(" ","-").replace(/\s+/g,"-").replace(/--+/g,"-")}async function GetFormData(formId){var formAction=$(`#${formId}`).attr("action");try{const response=await $.ajax({type:"GET",url:formAction,data:$(`#${formId}`).serialize()});return response.data}catch(error){return console.error("Error submitting form:",error),null}}async function Get(url){try{const response=await $.ajax({url:url});return response}catch(error){return console.error("Error submitting form:",error),null}}async function GetFormResult(formId){var formAction=$(`#${formId}`).attr("action"),type=$(`#${formId}`).attr("method");try{const response=await $.ajax({type:type,url:formAction,data:$(`#${formId}`).serialize()});return response}catch(error){return console.error("Error submitting form:",error),null}}function open_waiting(selector="body"){$(selector).waitMe({effect:"stretch",text:"لطفا صبر کنید ...",bg:"rgba(255,255,255,0.7)",color:"#000"})}function close_waiting(selector="body"){$(selector).waitMe("hide")}function ShowMessage(title,text,theme){window.createNotification({closeOnClick:!0,positionClass:"nfc-top-right",showDuration:3e3,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,theme:theme})({title:title,message:decodeURI(text)})}function ShowMessageByResponse(response){var status;switch(response.status.toLowerCase()){case"danger":ShowErrorMessage(response.message);break;case"warning":ShowWarningMessage(response.message);break;case"info":ShowInfoMessage(response.message);break;case"success":ShowSuccessMessage(response.message)}}function ShowSuccessMessage(text){ShowMessage("اعلان موفقیت",text,"success")}function ShowInfoMessage(text){ShowMessage("اعلان اطلاعیه",text,"info")}function ShowWarningMessage(text){ShowMessage("اعلان اخطار",text,"warning")}function ShowErrorMessage(text){ShowMessage("اعلان خطا",text,"error")}function InitialSubListValidation(){$("[data-property-name]").change((function(e){IsSingleInputValid($(this))})),$("[data-property-name]").keyup((function(e){IsSingleInputValid($(this))}))}function ValidateUnique(objectName){var isValid=!0,uniqueFormProperties=$(`.add-sub-item-form[data-object-name="${objectName}"]`).find(`[data-object-name='${objectName}'][data-property-name][is-unique]`),dataUniqueProperteis=[];return $(`.single-sub-list[data-object-name='${objectName}']`).each((function(index,container){$(this).find(`[data-object-name='${objectName}'][data-property-name][is-unique]`).each((function(subIndex,input){dataUniqueProperteis.push(input)}))})),$(uniqueFormProperties).each((function(index,prop){var propertyName=$(prop).data("property-name"),value=$(prop).val(),exists;dataUniqueProperteis.some((function(element){return $(element).data("property-name")===propertyName&&$(element).val()===value}))?(ShowSingleInputValidationCustomMessage(prop,"آیتمی با این مقدار از قبل وجود دارد",!1),isValid=!1):ShowSingleInputValidationCustomMessage(prop,"",!0)})),isValid}function RemoveSubList(button){var objectName=$(button).attr("data-object-name");$(button).parent().remove(),ReIndexSubLists(objectName)}function ReIndexSubLists(objectName){$(`.single-sub-list[data-object-name='${objectName}']`).each((function(index,container){$(this).find(`[data-object-name='${objectName}'][data-property-name]`).each((function(subIndex,input){var propertyName=$(input).data("property-name");if($(input).attr("name",`${objectName}[${index}].${propertyName}`),$(input).removeAttr("id"),$(input).is("select")||$(input).is("textarea")){var value=$(input).attr("value");$(input).val(value).trigger("change")}})),$(this).find("[data-valmsg-for]").each((function(subIndex,element){var propertyName=$(element).data("validation-property-name");$(element).attr("data-valmsg-for",`${objectName}[${index}].${propertyName}`)}))})),InitialAmountTexts(),InitialSubListValidation()}function AreInputsValid(selector){var isValid=!0;return $(selector).each((function(index,element){var singleElementValid=IsSingleInputValid(element);isValid=isValid&&singleElementValid})),isValid}function HasAttr(element,attr){var attr,hasAttr;return void 0!==(attr=$(element).attr(attr))&&!1!==attr}function IsSingleInputValid(input){var value=$(input).val(),isRequired;if(HasAttr(input,"data-val-required")&&(null==value||""===value))return ShowSingleInputValidationErrorMessage(input,"data-val-required"),!1;if(null!=value&&""!==value){var minValue,maxValue;if(+value<+$(input).attr("data-val-range-min"))return ShowSingleInputValidationErrorMessage(input,"data-val-range"),!1;if(+value>+$(input).attr("data-val-range-max"))return ShowSingleInputValidationErrorMessage(input,"data-val-range"),!1}return ShowSingleInputValidationErrorMessage(input,"",!0),!0}function ShowSingleInputValidationErrorMessage(input,messageAttr,isValid=!1){var inputName=$(input).attr("name"),span=$(`span[data-valmsg-for='${inputName}']`);if(isValid)return $(span).text(""),$(span).removeClass("field-validation-error"),void $(span).addClass("field-validation-valid");var errorMessage=$(input).attr(messageAttr);$(span).text(errorMessage),$(span).addClass("field-validation-error"),$(span).removeClass("field-validation-valid")}function ShowSingleInputValidationCustomMessage(input,message,isValid=!1){var inputName=$(input).attr("name"),span=$(`span[data-valmsg-for='${inputName}']`);if(isValid)return $(span).text(""),$(span).removeClass("field-validation-error"),void $(span).addClass("field-validation-valid");$(span).text(message),$(span).addClass("field-validation-error"),$(span).removeClass("field-validation-valid")}jQuery.extend({ConvertImageNameToWebP:function(imageName){return imageName.replace(/\.(png|jpg|jpeg|gif)$/,".webp")}}),function($){$.extend({ToAmount:function(num){return isNaN(num)?null:num.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" تومان"}})}(jQuery),$(document).ready((function(){$('input[type="file"]').change((function(e){var input=this,imageClassName=$(this).attr("data-value"),multiple=$(this).attr("multiple");if(this.files){if(1===this.files.length){var reader=new FileReader;reader.onload=function(e){$(`.${imageClassName}`).attr("src",e.target.result)},reader.readAsDataURL(this.files[0])}multiple&&($(`.${imageClassName}`).empty(),$(this.files).each((function(index,item){var reader=new FileReader;reader.onload=function(e){var imageHtml=`\n                    <div class="col-4 col-sm-6 mb-sm-2">\n                        <div class="avatar avatar-5xl">\n                            <img class="rounded-circle"\n                            src="${e.target.result}" alt="${index}" title="${index}">\n                        </div>\n                    </div>`;$(`.${imageClassName}`).append(imageHtml)},reader.readAsDataURL(item)})))}})),$('a[data-type="submit"]').click((function(event){var form;event.preventDefault(),$(this).closest("form").submit()})),$(".select-with-default-value").each((function(index,element){var value=$(element).attr("value");console.log(element),console.log(value),$(element).val(value).trigger("change")}))})),document.addEventListener("DOMContentLoaded",(function(){var inputs;document.querySelectorAll("[data-val-required]").forEach((function(input){var label=document.querySelector('label[for="'+input.id+'"]');label&&(label.innerHTML+=' <span style="color: red;">*</span>')})),InitialAmountTexts()})),$(".export-btn").click((function(e){e.preventDefault();var href=$(this).attr("href"),currentFilterFormHref=$(".filter-form").attr("action");$(".filter-form").attr("action",href),$(".filter-form").submit(),$(".filter-form").attr("action",currentFilterFormHref)})),$(document).ready((function(){var editors=$("[ckeditor]");editors.length>0&&$.getScript("/Shared/ckeditor.js",(function(){$(editors).each((function(index,value){var id=$(value).attr("ckeditor");ClassicEditor.create(document.querySelector('[ckeditor="'+id+'"]'),{toolbar:{items:["heading","|","bold","italic","link","|","fontSize","fontColor","|","imageUpload","blockQuote","insertTable","undo","redo","codeBlock"]},language:"fa",table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},licenseKey:"",simpleUpload:{uploadUrl:"/Uploader/UploadImage"}}).then(editor=>{window.editor=editor}).catch(err=>{console.error(err)})}))})),$("[ajax-url-button]").on("click",(function(e){e.preventDefault();var url=$(this).attr("href"),itemId=$(this).attr("ajax-url-button");$.get(url).then(result=>{"Success"===result.status?($("#ajax-url-item-"+itemId).hide(500),setTimeout((function(){$("#ajax-url-item-"+itemId).remove(),ShowSuccessMessage(result.message),ShowInfoMessage("پس از لود مجدد صفحه آیتم ها به شما نمایش داده خواهند شد")}),500)):ShowErrorMessage(result.message)})})),$(".ajax-link").click((async function(e){e.preventDefault(),open_waiting("body");var url=$(this).attr("href"),result=await Get(url);close_waiting("body"),ShowMessageByResponse(result),location.reload()}));const persianDatePicker={months:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],dowTitle:["شنبه","یکشنبه","دوشنبه","سه شنبه","چهارشنبه","پنج شنبه","جمعه"],shortDowTitle:["ش","ی","د","س","چ","پ","ج"],showGregorianDate:!1,persianNumbers:!0,formatDate:"YYYY/MM/DD",selectedBefore:!1,selectedDate:null,startDate:null,endDate:null,prevArrow:"◄",nextArrow:"►",theme:"default",alwaysShow:!1,selectableYears:null,selectableMonths:[1,2,3,4,5,6,7,8,9,10,11,12],cellWidth:25,cellHeight:20,fontSize:13,isRTL:!1,calendarPosition:{x:0,y:0},onShow:function(){},onHide:function(){},onSelect:function(){},onRender:function(){}};$(".persian-date-picker").persianDatepicker(persianDatePicker),$(".PersianDate-input").persianDatepicker(persianDatePicker)})),$(document).ready((function(e){$("form").each((function(){var form=$(this);$(form).validate({errorClass:"text-danger",errorElement:"span",errorPlacement:function(error,element){error.insertAfter(element.closest(".form-floating"))}})})),$(".add-sub-list-item-btn").click((function(){var objectName=$(this).data("object-name"),isValid;if(AreInputsValid(`[data-object-name='${objectName}'][data-property-name][id]`)){if(!ValidateUnique(objectName))return;$(`.add-sub-item-form[data-object-name='${objectName}']`).find("[data-property-name]").each((function(index,input){var value=$(input).val();console.log(input),console.log(value),$(input).attr("value",value)}));var addFormHtml=$(`.add-sub-item-form[data-object-name='${objectName}']`).html(),html;$(`\n            <div class="single-sub-list row g-5" data-object-name="${objectName}">\n                ${addFormHtml}\n                <button type="button" data-object-name="${objectName}" onclick="RemoveSubList(this)"\n                class="btn btn-danger remove-sub-list-btn col-sm-4">حذف</button>\n                <hr/>\n            </div> \n            `).insertBefore(`.add-sub-item-form[data-object-name='${objectName}']`),ReIndexSubLists(objectName),$(`.add-sub-item-form[data-object-name='${objectName}']`).find("[data-property-name]").each((function(index,input){var resetValue=$(input).data("reset-value");null!=resetValue&&($(input).val(resetValue),$(input).nextAll("p").text(""))}))}})),$(".remove-sub-list-btn").click((function(e){RemoveSubList($(this))})),InitialSubListValidation()}));